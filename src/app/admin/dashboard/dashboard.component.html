<!-- ================= DASHBOARD ADMIN ================= -->
<div *ngIf="!loading" class="dashboard-container">

  <!-- ================= HEADER ================= -->
  <div class="dashboard-header">
    <div>
      <h1 class="page-title">
        <i class="fas fa-chart-line"></i> Dashboard <span class="text-primary">Admin</span>
      </h1>
      <p class="page-subtitle">
        <i class="fas fa-clock"></i> Vue globale de <span class="font-semibold text-primary">l'activité logistique</span>
      </p>
    </div>
    <div class="header-date">
      <i class="fas fa-calendar-day"></i>
      <span>{{ today | date: 'd MMMM yyyy' }}</span>
    </div>
  </div>

  <!-- ================= STATS PRINCIPALES ================= -->
  <div class="stats-grid">

    <div class="stat-card stat-card-blue">
      <div class="stat-icon">
        <i class="fas fa-shopping-cart"></i>
      </div>
      <div class="stat-content">
        <p class="stat-label">Commandes totales</p>
        <p class="stat-value">{{ totalOrders }}</p>
      </div>
      <div class="stat-trend">
        <i class="fas fa-arrow-up"></i> +12%
      </div>
    </div>

    <div class="stat-card stat-card-yellow">
      <div class="stat-icon">
        <i class="fas fa-hourglass-half"></i>
      </div>
      <div class="stat-content">
        <p class="stat-label">Commandes à livrer</p>
        <p class="stat-value">{{ pendingOrders }}</p>
      </div>
      <div class="stat-trend">
        <i class="fas fa-minus"></i> 0%
      </div>
    </div>

    <div class="stat-card stat-card-green">
      <div class="stat-icon">
        <i class="fas fa-check-circle"></i>
      </div>
      <div class="stat-content">
        <p class="stat-label">Livraisons réussies</p>
        <p class="stat-value">{{ successfulDeliveries }}</p>
      </div>
      <div class="stat-trend">
        <i class="fas fa-arrow-up"></i> +8%
      </div>
    </div>

    <div class="stat-card stat-card-red">
      <div class="stat-icon">
        <i class="fas fa-times-circle"></i>
      </div>
      <div class="stat-content">
        <p class="stat-label">Livraisons échouées</p>
        <p class="stat-value">{{ failedDeliveries }}</p>
      </div>
      <div class="stat-trend stat-trend-down">
        <i class="fas fa-arrow-down"></i> -3%
      </div>
    </div>

  </div>

  <!-- ================= GRAPHIQUE ET TAUX DE RÉUSSITE ================= -->
  <div class="chart-row">

    <!-- GRAPHIQUE -->
    <div class="chart-card">
      <div class="chart-header">
        <h3 class="chart-title">
          <i class="fas fa-chart-bar"></i> Activité <span class="text-primary">Logistique</span>
        </h3>
        <div class="period-selector">
          <button
            type="button"
            class="period-btn"
            [class.active]="period === 'week'"
            (click)="changePeriod('week')">
            <i class="fas fa-calendar-week"></i> Semaine
          </button>
          <button
            type="button"
            class="period-btn"
            [class.active]="period === 'month'"
            (click)="changePeriod('month')">
            <i class="fas fa-calendar-alt"></i> Mois
          </button>
        </div>
      </div>
      <div class="chart-content">
        <canvas #activityChart></canvas>
      </div>
    </div>

    <!-- TAUX DE RÉUSSITE -->
    <div class="success-rate-card">
      <div class="success-rate-icon">
        <i class="fas fa-award"></i>
      </div>
      <p class="success-rate-label">Taux de réussite global</p>
      <div class="success-rate-value">
        {{ successRate }}<span class="percent">%</span>
      </div>
      <div class="success-rate-bar">
        <div class="success-rate-progress" [style.width.%]="successRate"></div>
      </div>
      <p class="success-rate-subtitle">
        <i class="fas fa-info-circle"></i> Performance excellente
      </p>
    </div>

  </div>

  <!-- ================= STATS SECONDAIRES ================= -->
  <div class="secondary-stats">

    <div class="secondary-stat-card">
      <div class="secondary-stat-icon stat-icon-purple">
        <i class="fas fa-user-check"></i>
      </div>
      <div class="secondary-stat-content">
        <p class="secondary-stat-label">Livreurs actifs</p>
        <p class="secondary-stat-value">{{ activeCouriers }}</p>
      </div>
    </div>

    <div class="secondary-stat-card">
      <div class="secondary-stat-icon stat-icon-orange">
        <i class="fas fa-shipping-fast"></i>
      </div>
      <div class="secondary-stat-content">
        <p class="secondary-stat-label">Livraisons en cours</p>
        <p class="secondary-stat-value">{{ ongoingDeliveries }}</p>
      </div>
    </div>

    <div class="secondary-stat-card">
      <div class="secondary-stat-icon stat-icon-red">
        <i class="fas fa-ban"></i>
      </div>
      <div class="secondary-stat-content">
        <p class="secondary-stat-label">Commandes annulées</p>
        <p class="secondary-stat-value">{{ cancelledOrders }}</p>
      </div>
    </div>

    <div class="secondary-stat-card">
      <div class="secondary-stat-icon stat-icon-blue">
        <i class="fas fa-coins"></i>
      </div>
      <div class="secondary-stat-content">
        <p class="secondary-stat-label">Total aujourd'hui</p>
        <p class="secondary-stat-value">{{ todayTotal }} €</p>
      </div>
    </div>

  </div>

</div>

<!-- ================= CHARGEMENT ================= -->
<div *ngIf="loading" class="loading-container">
  <div class="spinner">
    <i class="fas fa-circle-notch fa-spin"></i>
  </div>
  <p class="loading-text">Chargement du dashboard...</p>
</div>
